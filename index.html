<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å®¶åº­ç§æˆ¿èœå• - æŒ‡æŒ¥ä¸­å¿ƒç‰ˆ</title>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ============ 1. å…¨å±€è®¾ç½® ============ */
        html { scroll-behavior: smooth; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            background-color: #f0f2f5; color: #333; margin: 0; padding-bottom: 100px;
        }
        /* éšè—æ»šåŠ¨æ¡ä½†ä¿ç•™åŠŸèƒ½ */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 4px; }

        /* ============ 2. å¤´éƒ¨ä¸æ°›å›´ ============ */
        header { 
            background-image: linear-gradient(to bottom, rgba(0,0,0,0.4), rgba(0,0,0,0.8)), url('1.jpg'); 
            background-size: cover; background-position: center;
            color: white; text-align: center; padding: 100px 20px 140px; 
            position: relative; transition: all 0.5s;
        }
        /* æ°›å›´æ¨¡å¼ä¸‹çš„Headeræ ·å¼ */
        body.vibes-mode header { filter: hue-rotate(10deg) contrast(1.1); }

        h1 { font-size: 38px; margin: 0 0 10px 0; text-shadow: 0 2px 10px rgba(0,0,0,0.5); letter-spacing: 2px; }
        .intro { font-size: 15px; opacity: 0.9; margin-bottom: 25px; font-weight: 300; }

        /* é¡¶éƒ¨åŠŸèƒ½æ  (éŸ³ä¹ & æœç´¢) */
        .top-bar { max-width: 600px; margin: 0 auto; display: flex; align-items: center; gap: 10px; margin-bottom: 20px; justify-content: center; }
        
        /* éŸ³ä¹æŒ‰é’® */
        .music-btn {
            width: 45px; height: 45px; border-radius: 50%; border: none;
            background: rgba(255,255,255,0.2); color: white; cursor: pointer;
            display: flex; align-items: center; justify-content: center; font-size: 18px;
            backdrop-filter: blur(5px); transition: 0.3s;
        }
        .music-btn.playing { background: #ff6b6b; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); } }

        /* æœç´¢æ¡† */
        #searchInput {
            flex: 1; padding: 12px 20px; font-size: 16px; border: none; border-radius: 30px;
            background: rgba(255, 255, 255, 0.95); outline: none;
        }

        /* æ ‡ç­¾ç­›é€‰ */
        .filter-tags { display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; }
        .filter-btn {
            background: rgba(0,0,0,0.4); border: 1px solid rgba(255,255,255,0.2); color: white;
            padding: 6px 16px; border-radius: 20px; cursor: pointer; font-size: 14px; transition: 0.2s;
        }
        .filter-btn.active, .filter-btn:hover { background: white; color: #333; font-weight: bold; }

        /* ============ 3. å¡ç‰‡ç¿»è½¬ç‰¹æ•ˆ (Flip) ============ */
        .container { 
            max-width: 900px; margin: -100px auto 20px; padding: 20px; 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 30px; position: relative; z-index: 10;
        }

        /* 3D å®¹å™¨ */
        .flip-card {
            background-color: transparent;
            height: 320px; /* å›ºå®šé«˜åº¦ */
            perspective: 1000px; /* å¼€å¯3Dé€è§† */
            cursor: pointer;
        }
        
        .flip-card-inner {
            position: relative; width: 100%; height: 100%; text-align: center;
            transition: transform 0.6s; transform-style: preserve-3d;
            border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        /* é¼ æ ‡æ”¾ä¸Šå»ç¿»è½¬ (æ‰‹æœºä¸Šç‚¹å‡»ä¹Ÿè¡Œ) */
        .flip-card:hover .flip-card-inner { transform: rotateY(180deg); }

        /* æ­£é¢å’ŒèƒŒé¢å…¬å…±æ ·å¼ */
        .flip-card-front, .flip-card-back {
            position: absolute; width: 100%; height: 100%;
            -webkit-backface-visibility: hidden; backface-visibility: hidden; /* éšè—èƒŒé¢ */
            border-radius: 16px; overflow: hidden; background: white;
            display: flex; flex-direction: column;
        }

        /* æ­£é¢ï¼šå›¾ç‰‡+æ ‡é¢˜ */
        .flip-card-front { color: #333; }
        .card-img { width: 100%; height: 220px; object-fit: cover; }
        .card-info { padding: 15px; flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .card-title { margin: 0; font-size: 20px; color: #2c3e50; }
        .card-meta { font-size: 13px; color: #888; margin-top: 5px; }

        /* èƒŒé¢ï¼šé£Ÿæé€Ÿè§ˆ+æ“ä½œ */
        .flip-card-back {
            background: #2f3640; color: white; transform: rotateY(180deg);
            padding: 20px; box-sizing: border-box; justify-content: space-between;
        }
        .back-title { font-size: 16px; color: #f1c40f; margin-bottom: 10px; font-weight: bold; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 5px;}
        .ing-preview { text-align: left; font-size: 14px; line-height: 1.6; color: #dcdde1; flex: 1; }
        .back-actions { display: flex; gap: 10px; justify-content: center; }
        .btn-sm {
            padding: 8px 15px; border-radius: 20px; border: none; font-size: 13px; font-weight: bold; cursor: pointer; flex: 1;
        }
        .btn-add { background: #4cd137; color: white; }
        .btn-add.added { background: #e84118; }
        .btn-detail { background: white; color: #333; }

        /* ============ 4. åº•éƒ¨åŠŸèƒ½æ  (è´­ç‰©è½¦) ============ */
        #cartBar {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(150%);
            width: 90%; max-width: 450px;
            background: #2f3640; color: white;
            padding: 12px 20px; border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: flex; justify-content: space-between; align-items: center;
            z-index: 100; transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }
        #cartBar.show { transform: translateX(-50%) translateY(0); }
        .cart-info { font-weight: bold; font-size: 15px; display: flex; align-items: center; gap: 10px; }
        .cart-count { background: #e84118; padding: 2px 8px; border-radius: 10px; font-size: 12px; }

        /* éšæœºéª°å­æŒ‰é’® */
        #randomBtn {
            position: fixed; bottom: 100px; right: 20px;
            width: 55px; height: 55px; background: linear-gradient(135deg, #a55eea, #45aaf2);
            color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 24px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); z-index: 90; cursor: pointer;
            transition: transform 0.2s;
        }
        #randomBtn:active { transform: scale(0.9) rotate(360deg); }

        /* ============ 5. è¯¦æƒ…é¡µ & å¨å¸ˆæ¨¡å¼ & è®¡æ—¶å™¨ ============ */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 999; backdrop-filter: blur(3px);
            display: none; opacity: 0; transition: opacity 0.3s;
            justify-content: center; align-items: flex-end;
        }
        .modal-overlay.active { display: flex; opacity: 1; }
        
        .modal-content {
            background: white; width: 100%; max-width: 700px; height: 90vh;
            border-radius: 20px 20px 0 0; overflow-y: auto; position: relative; 
            box-shadow: 0 -10px 40px rgba(0,0,0,0.2); transform: translateY(100%); transition: transform 0.3s;
        }
        @media (min-width: 600px) {
            .modal-overlay { align-items: center; padding: 20px; }
            .modal-content { height: auto; max-height: 85vh; border-radius: 16px; transform: scale(0.95); }
        }
        .modal-overlay.active .modal-content { transform: translateY(0); }
        @media (min-width: 600px) { .modal-overlay.active .modal-content { transform: scale(1); } }

        /* è¯¦æƒ…å†…å®¹ */
        .detail-header-img { width: 100%; height: 260px; object-fit: cover; }
        .detail-body { padding: 25px; }
        .close-modal { 
            position: absolute; top: 15px; right: 15px; background: rgba(0,0,0,0.6); color: white;
            width: 32px; height: 32px; border-radius: 50%; text-align: center; line-height: 32px; cursor: pointer; z-index: 20;
        }

        /* è®¡æ—¶å™¨å·¥å…·æ  */
        .timer-bar {
            background: #f1f2f6; padding: 15px; border-radius: 12px; margin: 15px 0;
            display: flex; justify-content: space-between; align-items: center;
        }
        .timer-display { font-family: monospace; font-size: 24px; font-weight: bold; color: #333; }
        .timer-controls button {
            border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-weight: bold; margin-left: 5px;
        }
        .btn-start { background: #4cd137; color: white; }
        .btn-reset { background: #dfe4ea; color: #333; }

        /* ä¸“æ³¨æ¨¡å¼ */
        .cook-mode-toggle {
            display: flex; align-items: center; justify-content: space-between;
            background: #2f3640; color: white; padding: 12px 20px; border-radius: 12px; margin-bottom: 20px; cursor: pointer;
        }
        
        /* ä¸“æ³¨æ¨¡å¼æ¿€æ´»æ ·å¼ */
        body.cooking-mode .modal-content {
            position: fixed; top: 0; left: 0; height: 100vh; max-height: 100vh; width: 100vw; max-width: 100vw;
            border-radius: 0; background: #1e272e; color: #ecf0f1; z-index: 2000;
        }
        body.cooking-mode .detail-header-img, body.cooking-mode .close-modal, body.cooking-mode .detail-meta { display: none; }
        body.cooking-mode .detail-body { padding: 40px 20px; }
        body.cooking-mode h2 { color: #ffa801; font-size: 32px; border-bottom: 1px solid #57606f; padding-bottom: 15px;}
        body.cooking-mode .section-title { color: #00d2d3; font-size: 24px; margin-top: 30px; }
        body.cooking-mode li { font-size: 22px; margin-bottom: 25px; line-height: 1.6; }
        body.cooking-mode .timer-bar { background: #485460; color: white; }
        body.cooking-mode .timer-display { color: #00d2d3; }

        ul, ol { padding-left: 20px; margin: 0; }
        li { margin-bottom: 8px; }
        .section-title { font-size: 18px; color: #ff6b6b; margin: 25px 0 10px 0; font-weight: bold; }
        .detail-meta { color: #888; font-size: 14px; margin-bottom: 10px; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<header>
    <div class="top-bar">
        <button class="music-btn" onclick="toggleMusic()" title="æ’­æ”¾æ°›å›´éŸ³ä¹"><i class="fas fa-music"></i></button>
        <input type="text" id="searchInput" placeholder="ä»Šå¤©æƒ³åƒä»€ä¹ˆï¼Ÿ">
    </div>

    <h1>ğŸ½ï¸ å®¶åº­ç§æˆ¿èœå•</h1>
    <div class="intro">ç‚¹å‡»å¡ç‰‡çœ‹åšæ³• Â· æ‚¬åœçœ‹é£Ÿæ</div>
    
    <div class="filter-tags">
        <div class="filter-btn active" onclick="filter('all', this)">å…¨éƒ¨</div>
        <div class="filter-btn" onclick="filter('æ—©é¤', this)">æ—©é¤</div>
        <div class="filter-btn" onclick="filter('ç¡¬èœ', this)">ç¡¬èœ</div>
        <div class="filter-btn" onclick="filter('ç”œç‚¹', this)">ç”œç‚¹</div>
    </div>
</header>

<div class="container" id="recipeContainer">
    </div>

<div id="randomBtn" onclick="pickRandom()"><i class="fas fa-dice"></i></div>

<div id="cartBar" onclick="showCartSummary()">
    <div class="cart-info">
        <i class="fas fa-shopping-basket"></i>
        <span>ä»Šæ—¥èœå•</span>
        <span class="cart-count" id="cartCount">0</span>
    </div>
    <div style="font-size: 13px; color: #ccc;">æŸ¥çœ‹æ¸…å• <i class="fas fa-chevron-right"></i></div>
</div>

<div class="modal-overlay" id="detailModal">
    <div class="modal-content">
        <div class="close-modal" onclick="closeModal()"><i class="fas fa-times"></i></div>
        
        <img src="" class="detail-header-img" id="modalImg">
        
        <div class="detail-body">
            <div class="cook-mode-toggle" onclick="toggleCookMode()">
                <span><i class="fas fa-eye"></i> å¨å¸ˆä¸“æ³¨æ¨¡å¼</span>
                <i class="fas fa-toggle-off" id="toggleIcon"></i>
            </div>

            <div class="timer-bar">
                <div class="timer-controls">
                    <span style="font-size:14px; margin-right:5px;">è®¡æ—¶å™¨:</span>
                    <button class="btn-start" onclick="startTimer(5)">5åˆ†</button>
                    <button class="btn-start" onclick="startTimer(10)">10åˆ†</button>
                    <button class="btn-start" onclick="startTimer(30)">30åˆ†</button>
                    <button class="btn-reset" onclick="resetTimer()">é‡ç½®</button>
                </div>
                <div class="timer-display" id="timerDisplay">00:00</div>
            </div>

            <h2 id="modalTitle">èœå</h2>
            <div class="detail-meta" id="modalMeta">éš¾åº¦ / æ—¶é—´</div>

            <div class="section-title"><i class="fas fa-carrot"></i> éœ€è¦é£Ÿæ</div>
            <ul id="modalIng"></ul>

            <div class="section-title"><i class="fas fa-fire-alt"></i> åšæ³•æ­¥éª¤</div>
            <ol id="modalSteps"></ol>
        </div>
    </div>
</div>

<audio id="bgmAudio" loop>
    <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
    // ============ 1. æ•°æ®é…ç½® (åœ¨è¿™é‡Œæ”¹èœè°±) ============
    const recipes = [
        {
            id: 1,
            title: "èƒ½é‡ç‰›æ²¹æœåå¸",
            img: "avocado.jpg",
            category: "æ—©é¤",
            meta: "10åˆ†é’Ÿ Â· ç®€å•",
            ingredients: ["å…¨éº¦åå¸ 2ç‰‡", "ç†Ÿç‰›æ²¹æœ 1ä¸ª", "é¸¡è›‹ 1ä¸ª", "æŸ æª¬æ±", "é»‘èƒ¡æ¤’"],
            steps: ["ç‰›æ²¹æœå»æ ¸ï¼ŒåŠ æŸ æª¬æ±å‹æˆæ³¥ã€‚", "å°ç«ç…ä¸€ä¸ªå•é¢æµå¿ƒè›‹ã€‚", "åå¸çƒ¤è„†ï¼ŒæŠ¹æœæ³¥ï¼Œæ”¾è›‹ã€‚", "æ’’ç›å’Œé»‘èƒ¡æ¤’å¼€åƒã€‚"]
        },
        {
            id: 2,
            title: "ç§˜åˆ¶æœ¬å¸®çº¢çƒ§è‚‰",
            img: "meat.jpg",
            category: "ç¡¬èœ",
            meta: "90åˆ†é’Ÿ Â· éœ€è€å¿ƒ",
            ingredients: ["äº”èŠ±è‚‰ 500g", "å†°ç³– 30g", "è‘±å§œã€å…«è§’ã€é¦™å¶", "ç”ŸæŠ½ã€è€æŠ½ã€æ–™é…’"],
            steps: ["äº”èŠ±è‚‰ç„¯æ°´æ´—å‡€ã€‚", "ç‚’ç³–è‰²ï¼šå†°ç³–ç‚’è‡³æ£çº¢è‰²ä¸‹è‚‰ã€‚", "åŠ é¦™æ–™å’Œé…±æ²¹ç‚’é¦™ã€‚", "åŠ å¼€æ°´æ²¡è¿‡è‚‰ï¼Œå°ç«ç‚–50åˆ†é’Ÿã€‚", "å¤§ç«æ”¶æ±è‡³æµ“ç¨ ã€‚"]
        },
        {
            id: 3,
            title: "è‰è“ç‡•éº¦é…¸å¥¶æ¯",
            img: "yogurt.jpg",
            category: "ç”œç‚¹",
            meta: "5åˆ†é’Ÿ Â· æç®€",
            ingredients: ["æµ“ç¨ é…¸å¥¶ 1ç›’", "è‰è“ 6é¢—", "å³é£Ÿç‡•éº¦è„†"],
            steps: ["è‰è“åˆ‡ä¸ï¼Œç•™ä¸€é¢—è£…é¥°ã€‚", "ä¸€å±‚ç‡•éº¦ï¼Œä¸€å±‚é…¸å¥¶ã€‚", "è´´å£æ”¾è‰è“ç‰‡ï¼Œä¸­é—´å¡«æœè‚‰ã€‚", "é¡¶éƒ¨è£…é¥°æ•´é¢—è‰è“ã€‚"]
        }
    ];

    // ============ 2. æ¸²æŸ“é€»è¾‘ ============
    const container = document.getElementById('recipeContainer');
    let cart = []; 

    function renderRecipes(filterType) {
        container.innerHTML = '';
        recipes.forEach(item => {
            if (filterType === 'all' || item.category === filterType) {
                const card = document.createElement('div');
                card.className = 'flip-card searchable-item';
                // ç¿»è½¬å¡ç‰‡ç»“æ„ï¼šæ­£é¢ + èƒŒé¢
                card.innerHTML = `
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <img src="${item.img}" class="card-img">
                            <div class="card-info">
                                <h3 class="card-title">${item.title}</h3>
                                <div class="card-meta">${item.meta}</div>
                            </div>
                        </div>
                        <div class="flip-card-back">
                            <div>
                                <div class="back-title">æ‰€éœ€é£Ÿæ</div>
                                <div class="ing-preview">
                                    ${item.ingredients.map(ing => `â€¢ ${ing}`).join('<br>')}
                                </div>
                            </div>
                            <div class="back-actions">
                                <button class="btn-sm btn-detail" onclick="openDetail(${item.id})">çœ‹åšæ³•</button>
                                <button class="btn-sm btn-add" id="btn-add-${item.id}" onclick="toggleCart(${item.id}, this)">
                                    åŠ å…¥èœå•
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            }
        });
    }
    renderRecipes('all');

    // ============ 3. æ ¸å¿ƒåŠŸèƒ½ ============
    
    // --- ç­›é€‰ & æœç´¢ ---
    function filter(type, btn) {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderRecipes(type);
        // é‡æ–°æ¸²æŸ“åæ¢å¤è´­ç‰©è½¦çŠ¶æ€
        cart.forEach(id => {
            const btn = document.getElementById(`btn-add-${id}`);
            if(btn) { btn.classList.add('added'); btn.innerText = "å·²åŠ å…¥"; }
        });
    }
    document.getElementById('searchInput').addEventListener('keyup', (e) => {
        const val = e.target.value.toLowerCase();
        document.querySelectorAll('.flip-card').forEach(card => {
            card.style.display = card.innerText.toLowerCase().includes(val) ? 'block' : 'none';
        });
    });

    // --- è´­ç‰©è½¦/ä»Šæ—¥èœå• ---
    function toggleCart(id, btn) {
        // é˜²æ­¢ç‚¹å‡»ç©¿é€è§¦å‘è¯¦æƒ…
        event.stopPropagation();
        const index = cart.indexOf(id);
        if (index === -1) {
            cart.push(id);
            btn.classList.add('added');
            btn.innerText = "å·²åŠ å…¥";
        } else {
            cart.splice(index, 1);
            btn.classList.remove('added');
            btn.innerText = "åŠ å…¥èœå•";
        }
        updateCartBar();
    }
    function updateCartBar() {
        const bar = document.getElementById('cartBar');
        document.getElementById('cartCount').innerText = cart.length;
        bar.classList.toggle('show', cart.length > 0);
    }
    function showCartSummary() {
        if (cart.length === 0) return;
        let text = "ğŸ›’ ä»Šæ—¥ä¹°èœæ¸…å•ï¼š\n\n";
        cart.forEach(id => {
            const item = recipes.find(r => r.id === id);
            text += `ã€${item.title}ã€‘\n${item.ingredients.join('ã€')}\n\n`;
        });
        if(confirm(text + "--------\nç‚¹å‡»ã€ç¡®å®šã€‘å¤åˆ¶æ¸…å•åˆ°å‰ªè´´æ¿")) {
             navigator.clipboard.writeText(text).then(() => alert("âœ… å·²å¤åˆ¶ï¼"));
        }
    }

    // --- éšæœºé€‰èœ ---
    function pickRandom() {
        const items = document.querySelectorAll('.flip-card');
        if(items.length === 0) return;
        const randomIdx = Math.floor(Math.random() * items.length);
        
        // æ’’èŠ±
        confetti({ particleCount: 150, spread: 100, origin: { y: 0.8 } });
        
        // æ»šåŠ¨åˆ°è¯¥ä½ç½®å¹¶ç¨å¾®éœ‡åŠ¨æç¤º
        items[randomIdx].scrollIntoView({ behavior: 'smooth', block: 'center' });
        items[randomIdx].style.transform = "scale(1.05)";
        setTimeout(() => items[randomIdx].style.transform = "scale(1)", 500);
        
        // è‡ªåŠ¨æ‰“å¼€èƒŒé¢æ˜¾ç¤ºè¯¦æƒ…æŒ‰é’®
        // (æ³¨ï¼šç”±äºCSS hoverç¿»è½¬ï¼Œè¿™é‡Œä¸»è¦é€šè¿‡æ»šåŠ¨æç¤º)
    }

    // --- èƒŒæ™¯éŸ³ä¹ ---
    const bgm = document.getElementById('bgmAudio');
    function toggleMusic() {
        const btn = document.querySelector('.music-btn');
        if (bgm.paused) {
            bgm.play().then(() => {
                btn.classList.add('playing');
                document.body.classList.add('vibes-mode');
            }).catch(e => {
                alert("è¯·å…ˆæ·»åŠ éŸ³ä¹æ–‡ä»¶ï¼š\næ‰¾ä¸€é¦–mp3ï¼Œé‡å‘½åä¸º music.mp3ï¼Œæ”¾åœ¨å›¾ç‰‡æ–‡ä»¶å¤¹é‡Œã€‚");
            });
        } else {
            bgm.pause();
            btn.classList.remove('playing');
            document.body.classList.remove('vibes-mode');
        }
    }

    // --- è®¡æ—¶å™¨ ---
    let timerInterval;
    function startTimer(minutes) {
        clearInterval(timerInterval);
        let seconds = minutes * 60;
        updateTimerDisplay(seconds);
        
        timerInterval = setInterval(() => {
            seconds--;
            updateTimerDisplay(seconds);
            if (seconds <= 0) {
                clearInterval(timerInterval);
                alert("â° æ—¶é—´åˆ°å•¦ï¼å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥äº†ï¼");
                // å°è¯•å‘å‡ºç®€å•çš„ç³»ç»Ÿæç¤ºéŸ³ï¼ˆå¦‚æœæµè§ˆå™¨å…è®¸ï¼‰
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const osc = ctx.createOscillator();
                osc.connect(ctx.destination);
                osc.start();
                osc.stop(ctx.currentTime + 0.5);
            }
        }, 1000);
    }
    function resetTimer() {
        clearInterval(timerInterval);
        document.getElementById('timerDisplay').innerText = "00:00";
    }
    function updateTimerDisplay(seconds) {
        const m = Math.floor(seconds / 60).toString().padStart(2, '0');
        const s = (seconds % 60).toString().padStart(2, '0');
        document.getElementById('timerDisplay').innerText = `${m}:${s}`;
    }

    // --- è¯¦æƒ…ä¸ä¸“æ³¨æ¨¡å¼ ---
    const modal = document.getElementById('detailModal');
    let isCookMode = false;

    function openDetail(id) {
        const item = recipes.find(r => r.id === id);
        document.getElementById('modalImg').src = item.img;
        document.getElementById('modalTitle').innerText = item.title;
        document.getElementById('modalMeta').innerText = item.meta;
        document.getElementById('modalIng').innerHTML = item.ingredients.map(i => `<li>${i}</li>`).join('');
        document.getElementById('modalSteps').innerHTML = item.steps.map(s => `<li>${s}</li>`).join('');
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeModal() {
        modal.classList.remove('active');
        document.body.style.overflow = 'auto';
        if(isCookMode) toggleCookMode(); // å…³é—­å¼¹çª—è‡ªåŠ¨é€€å‡ºä¸“æ³¨æ¨¡å¼
        resetTimer(); // å…³é—­å¼¹çª—è‡ªåŠ¨é‡ç½®è®¡æ—¶å™¨
    }

    function toggleCookMode() {
        isCookMode = !isCookMode;
        document.body.classList.toggle('cooking-mode', isCookMode);
        const icon = document.getElementById('toggleIcon');
        icon.className = isCookMode ? 'fas fa-toggle-on' : 'fas fa-toggle-off';
        icon.style.color = isCookMode ? '#4cd137' : '#fff';
    }

</script>

</body>
</html>